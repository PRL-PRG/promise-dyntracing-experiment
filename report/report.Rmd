---
title: "The Promise that R makes"
output:
  html_document:
    toc: true
    theme: united
params:
  summarized_data_dirpath: ../latest/analysis/summarized
  visualized_data_dirpath: ../latest/analysis/visualized
  binary: FALSE
  compression_level: 0
  image_format: png
editor_options:
  chunk_output_type: console
---

<style type="text/css">
.main-container {
  max-width: 1200px;
  margin-left: auto;
  margin-right: auto;
  padding-left: 15px;
  padding-right: 15px;
}

.datatables {
    height: 575px !important; 
}
</style>

```{r echo = FALSE, message = FALSE}
library(DT)
library(fs)
library(png)
library(stringr)
library(dplyr)
library(magrittr)
library(rlang)
library(knitr)
library(png)
library(grid)
library(gridExtra)
library(promisedyntracer)
```

```{r datatsets, echo = FALSE, message = TRUE}
show_table <- function(tablename) {
    path(params$summarized_data_dirpath, tablename) %>%
    read_data_table(binary = params$binary, 
                    compression_level = params$compression_level) %>%
    datatable(fillContainer = TRUE, filter = "top")
}

show_graph <- function(graphname) {
    path(params$visualized_data_dirpath, graphname, ext = "png") %>%
    include_graphics()
}

show_graphs <- function(first_graphname, second_graphname) {
    load_graph <- function(graphname) {
        grid::rasterGrob(as.raster(readPNG(path(params$visualized_data_dirpath, 
                                                graphname, 
                                                ext = "png"))),
                         interpolate = TRUE)
    }
    grid.arrange(load_graph(first_graphname),
                 load_graph(second_graphname),
                 ncol = 2)
}
```
```{r utilities, echo = FALSE}
count_labels <-
    Vectorize(function(x, digits = 2) {
    
      paste_round <- function(value, div, suffix, sep)
          paste(round(value/div, digits), suffix, sep = sep)
    
      if(is.na(x)) {
        "NA"
      } else if(x < 10^3) {
        paste0(x)
      } else if(x < 10^6) {
        paste_round(x, 1000, "K", sep=" ")
      } else if(x < 10^9) {
        paste_round(x, 10^6, "M", sep=" ")
      } else {
        paste_round(x, 10^9, "B", sep=" ")
      }
    },
    "x")
```


```{r echo = FALSE, out.width="1000px"}
show_graph("object_count_by_type")
```

```{r echo = FALSE}
show_table("object_count_by_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("function_call_count_by_type")
```

```{r echo = FALSE}
show_table("function_call_count_by_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("function_count_by_type")
```

```{r echo = FALSE}
show_table("function_count_by_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("function_call_count_by_method_type")
```

```{r echo = FALSE}
show_table("function_call_count_by_method_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("function_count_by_method_type")
```

```{r echo = FALSE}
show_table("function_count_by_method_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("closure_count_by_call_count")
```

```{r echo = FALSE}
show_table("closure_count_by_call_count")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("closure_count_by_formal_parameter_count")
```

```{r echo = FALSE}
show_table("closure_count_by_formal_parameter_count")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("function_call_count_by_return_value_type")
```

```{r echo = FALSE}
show_table("function_call_count_by_return_value_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("builtin_count_by_return_value_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("special_count_by_return_value_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("closure_count_by_return_value_type")
```

```{r echo = FALSE}
show_table("function_count_by_return_value_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("closure_count_by_wrapper_and_force_order")
```

```{r echo = FALSE}
show_table("closure_count_by_wrapper_and_force_order")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("function_call_count_by_type_and_jump")
```

```{r echo = FALSE}
show_table("function_call_count_by_type_and_jump")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("function_call_count_by_type_and_jump")
```

```{r echo = FALSE}
show_table("function_call_count_by_type_and_jump")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("argument_count_by_type")
```

```{r echo = FALSE}
show_table("argument_count_by_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("non_missing_argument_count_by_dot_dot_dot")
```

```{r echo = FALSE}
show_table("non_missing_argument_count_by_dot_dot_dot")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_argument_count_by_nature")
```

```{r echo = FALSE}
show_table("promise_argument_count_by_nature")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_argument_count_by_sharing")
```

```{r echo = FALSE}
show_table("promise_argument_count_by_sharing")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_argument_count_by_expression_type")
```

```{r echo = FALSE}
show_table("promise_argument_count_by_expression_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_argument_count_by_value_type")
```

```{r echo = FALSE}
show_table("promise_argument_count_by_value_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_argument_count_by_force_type")
```

```{r echo = FALSE}
show_table("promise_argument_count_by_force_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_argument_count_by_direct_lookup_count")
```

```{r echo = FALSE}
show_table("promise_argument_count_by_direct_lookup_count")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_argument_count_by_direct_and_indirect_lookup_count")
```

```{r echo = FALSE}
show_table("promise_argument_count_by_direct_and_indirect_lookup_count")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_argument_count_by_direct_metaprogram_count")
```

```{r echo = FALSE}
show_table("promise_argument_count_by_direct_metaprogram_count")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_argument_count_by_direct_and_indirect_metaprogram_count")
```

```{r echo = FALSE}
show_table("promise_argument_count_by_direct_and_indirect_metaprogram_count")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_argument_count_by_dispatch_type")
```

```{r echo = FALSE}
show_table("promise_argument_count_by_dispatch_type")
```

```{r echo = FALSE}
show_table("promise_argument_forced_by_promise_argument")
```

```{r echo = FALSE}
show_table("promise_argument_returning_non_locally")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("argument_count_by_usage")
```

```{r echo = FALSE}
show_table("argument_count_by_usage")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("formal_parameter_count_by_usage")
```

```{r echo = FALSE}
show_table("formal_parameter_count_by_usage")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("formal_parameter_count_by_usage_class")
```

```{r echo = FALSE}
show_table("formal_parameter_count_by_usage_class")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("closure_count_distribution_by_usage_class")
```

```{r echo = FALSE}
show_table("closure_count_distribution_by_usage_class")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("escaped_argument_function_call_count_by_return_value_type")
```

```{r echo = FALSE}
show_table("escaped_argument_function_call_count_by_return_value_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("escaped_argument_function_count_by_return_value_type")
```

```{r echo = FALSE}
show_table("escaped_argument_function_count_by_return_value_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("escaped_argument_function_count_by_category")
```

```{r echo = FALSE}
show_table("escaped_argument_function_count_by_category")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("escaped_argument_count_by_nature")
```

```{r echo = FALSE}
show_table("escaped_argument_count_by_nature")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("escaped_argument_count_by_dispatch_type")
```

```{r echo = FALSE}
show_table("escaped_argument_count_by_dispatch_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("escaped_argument_count_by_expression_type")
```

```{r echo = FALSE}
show_table("escaped_argument_count_by_expression_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("escaped_argument_count_by_value_type")
```

```{r echo = FALSE}
show_table("escaped_argument_count_by_value_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("escaped_argument_count_by_force_type")
```

```{r echo = FALSE}
show_table("escaped_argument_count_by_force_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("escaped_argument_count_by_metaprogram_type")
```

```{r echo = FALSE}
show_table("escaped_argument_count_by_metaprogram_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("escaped_argument_count_by_lookup_type")
```

```{r echo = FALSE}
show_table("escaped_argument_count_by_lookup_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("escaped_argument_count_by_direct_self_scope_mutation_type")
```

```{r echo = FALSE}
show_table("escaped_argument_count_by_direct_self_scope_mutation_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("escaped_argument_count_by_indirect_self_scope_mutation_type")
```

```{r echo = FALSE}
show_table("escaped_argument_count_by_indirect_self_scope_mutation_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("escaped_argument_count_by_direct_lexical_scope_mutation_type")
```

```{r echo = FALSE}
show_table("escaped_argument_count_by_direct_lexical_scope_mutation_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("escaped_argument_count_by_indirect_lexical_scope_mutation_type")
```

```{r echo = FALSE}
show_table("escaped_argument_count_by_indirect_lexical_scope_mutation_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("escaped_argument_count_by_direct_non_lexical_scope_mutation_type")
```

```{r echo = FALSE}
show_table("escaped_argument_count_by_direct_non_lexical_scope_mutation_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("escaped_argument_count_by_indirect_non_lexical_scope_mutation_type")
```

```{r echo = FALSE}
show_table("escaped_argument_count_by_indirect_non_lexical_scope_mutation_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("escaped_argument_count_by_direct_self_scope_observation_type")
```

```{r echo = FALSE}
show_table("escaped_argument_count_by_direct_self_scope_observation_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("escaped_argument_count_by_indirect_self_scope_observation_type")
```

```{r echo = FALSE}
show_table("escaped_argument_count_by_indirect_self_scope_observation_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("escaped_argument_count_by_direct_lexical_scope_observation_type")
```

```{r echo = FALSE}
show_table("escaped_argument_count_by_direct_lexical_scope_observation_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("escaped_argument_count_by_indirect_lexical_scope_observation_type")
```

```{r echo = FALSE}
show_table("escaped_argument_count_by_indirect_lexical_scope_observation_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("escaped_argument_count_by_direct_non_lexical_scope_observation_type")
```

```{r echo = FALSE}
show_table("escaped_argument_count_by_direct_non_lexical_scope_observation_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("escaped_argument_count_by_indirect_non_lexical_scope_observation_type")
```

```{r echo = FALSE}
show_table("escaped_argument_count_by_indirect_non_lexical_scope_observation_type")
```


```{r echo = FALSE, out.width="1000px"}
show_graph("promise_count_by_category")
```

```{r echo = FALSE}
show_table("promise_count_by_category")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("argument_promise_count_by_expression_type")
```

```{r echo = FALSE}
show_table("argument_promise_count_by_expression_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("non_argument_promise_count_by_expression_type")
```

```{r echo = FALSE}
show_table("non_argument_promise_count_by_expression_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("argument_promise_count_by_value_type")
```

```{r echo = FALSE}
show_table("argument_promise_count_by_value_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("non_argument_promise_count_by_value_type")
```

```{r echo = FALSE}
show_table("non_argument_promise_count_by_value_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("argument_promise_count_by_creation_scope")
```

```{r echo = FALSE}
show_table("argument_promise_count_by_creation_scope")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("non_argument_promise_count_by_creation_scope")
```

```{r echo = FALSE}
show_table("non_argument_promise_count_by_creation_scope")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("argument_promise_count_by_forcing_scope")
```

```{r echo = FALSE}
show_table("argument_promise_count_by_forcing_scope")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("non_argument_promise_count_by_forcing_scope")
```

```{r echo = FALSE}
show_table("non_argument_promise_count_by_forcing_scope")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("argument_promise_count_by_dispatch_type")
```

```{r echo = FALSE}
show_table("argument_promise_count_by_dispatch_type")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("argument_promise_count_by_call_depth")
```

```{r echo = FALSE}
show_table("argument_promise_count_by_call_depth")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("argument_promise_count_by_promise_depth")
```

```{r echo = FALSE}
show_table("argument_promise_count_by_promise_depth")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("argument_promise_count_by_nested_promise_depth")
```

```{r echo = FALSE}
show_table("argument_promise_count_by_nested_promise_depth")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_count_by_force_count")
```

```{r echo = FALSE}
show_table("promise_count_by_force_count")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_count_by_metaprogram_count")
```

```{r echo = FALSE}
show_table("promise_count_by_metaprogram_count")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_count_by_value_lookup_count")
```

```{r echo = FALSE}
show_table("promise_count_by_value_lookup_count")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_count_by_value_assign_count")
```

```{r echo = FALSE}
show_table("promise_count_by_value_assign_count")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_count_by_expression_lookup_count")
```

```{r echo = FALSE}
show_table("promise_count_by_expression_lookup_count")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_count_by_expression_assign_count")
```

```{r echo = FALSE}
show_table("promise_count_by_expression_assign_count")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_count_by_environment_lookup_count")
```

```{r echo = FALSE}
show_table("promise_count_by_environment_lookup_count")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_count_by_environment_assign_count")
```

```{r echo = FALSE}
show_table("promise_count_by_environment_assign_count")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_count_by_direct_self_scope_mutation")
```

```{r echo = FALSE}
show_table("promise_count_by_direct_self_scope_mutation")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_count_by_indirect_self_scope_mutation")
```

```{r echo = FALSE}
show_table("promise_count_by_indirect_self_scope_mutation")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_count_by_direct_lexical_scope_mutation")
```

```{r echo = FALSE}
show_table("promise_count_by_direct_lexical_scope_mutation")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_count_by_indirect_lexical_scope_mutation")
```

```{r echo = FALSE}
show_table("promise_count_by_indirect_lexical_scope_mutation")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_count_by_direct_non_lexical_scope_mutation")
```

```{r echo = FALSE}
show_table("promise_count_by_direct_non_lexical_scope_mutation")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_count_by_indirect_non_lexical_scope_mutation")
```

```{r echo = FALSE}
show_table("promise_count_by_indirect_non_lexical_scope_mutation")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_count_by_direct_self_scope_observation")
```

```{r echo = FALSE}
show_table("promise_count_by_direct_self_scope_observation")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_count_by_indirect_self_scope_observation")
```

```{r echo = FALSE}
show_table("promise_count_by_indirect_self_scope_observation")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_count_by_direct_lexical_scope_observation")
```

```{r echo = FALSE}
show_table("promise_count_by_direct_lexical_scope_observation")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_count_by_indirect_lexical_scope_observation")
```

```{r echo = FALSE}
show_table("promise_count_by_indirect_lexical_scope_observation")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_count_by_direct_non_lexical_scope_observation")
```

```{r echo = FALSE}
show_table("promise_count_by_direct_non_lexical_scope_observation")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_count_by_indirect_non_lexical_scope_observation")
```

```{r echo = FALSE}
show_table("promise_count_by_indirect_non_lexical_scope_observation")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_use_distribution_by_category")
```

```{r echo = FALSE}
show_table("promise_use_distribution_by_category")
```

```{r echo = FALSE, out.width="1000px"}
show_graph("promise_action_distribution_by_category")
```

```{r echo = FALSE}
show_table("promise_action_distribution_by_category")
```
